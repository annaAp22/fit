function init(){var e={zoom:15,center:new google.maps.LatLng(55.711354,37.654629),scrollwheel:!1,styles:[{featureType:"water",elementType:"geometry",stylers:[{color:"#e9e9e9"},{lightness:17}]},{featureType:"landscape",elementType:"geometry",stylers:[{color:"#f5f5f5"},{lightness:20}]},{featureType:"road.highway",elementType:"geometry.fill",stylers:[{color:"#ffffff"},{lightness:17}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#ffffff"},{lightness:29},{weight:.2}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{color:"#ffffff"},{lightness:18}]},{featureType:"road.local",elementType:"geometry",stylers:[{color:"#ffffff"},{lightness:16}]},{featureType:"poi",elementType:"geometry",stylers:[{color:"#f5f5f5"},{lightness:21}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#dedede"},{lightness:21}]},{elementType:"labels.text.stroke",stylers:[{visibility:"on"},{color:"#ffffff"},{lightness:16}]},{elementType:"labels.text.fill",stylers:[{saturation:36},{color:"#333333"},{lightness:40}]},{elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"geometry",stylers:[{color:"#f2f2f2"},{lightness:19}]},{featureType:"administrative",elementType:"geometry.fill",stylers:[{color:"#fefefe"},{lightness:20}]},{featureType:"administrative",elementType:"geometry.stroke",stylers:[{color:"#fefefe"},{lightness:17},{weight:1.2}]}]},t=document.getElementById("map"),i=new google.maps.Map(t,e);new google.maps.Marker({position:new google.maps.LatLng(55.710074,37.654759),map:i,title:"Магазин",icon:"/img/map_point-min.png"});google.maps.event.addDomListener(window,"resize",function(){var e=i.getCenter();google.maps.event.trigger(i,"resize"),i.setCenter(e)})}function updateCart(e){if("undefined"!=typeof e.count&&$(".js-cart-quantity").text(e.count),"undefined"!=typeof e.modal&&openModal(e),"undefined"!=typeof e.removed){var t=$("[data-id="+e.removed+"]"),i=$(".js-total-amount");i.data("total",e.amount),i.text(number_format(e.amount,0,"."," ")+"₽"),t.remove()}}function nextStep(e){var t=$.isNumeric(e)?e:e.data("next_step");"undefined"!=typeof t&&($(".js-step").removeClass("active"),$(".js-step_"+t).addClass("active"))}function orderSuccess(e){$("#order-success").append(e.html),nextStep(3)}function openModal(e){"undefined"!=typeof e.modal&&($.fancybox.close(),$.fancybox.open([{src:e.modal,type:"inline"}],{closeBtn:!1,beforeClose:function(t,i,n){var a=i.$slide.find("form");"undefined"!=typeof a.data("submit-on-close")&&a.submit(),"undefined"!=typeof e.modalAction&&"refresh-on-close"==e.modalAction&&(window.location="/")}}))}function number_format(e,t,i,n){var a,s,o,r,c;return isNaN(t=Math.abs(t))&&(t=2),void 0==i&&(i=","),void 0==n&&(n="."),a=parseInt(e=(+e||0).toFixed(t))+"",(s=a.length)>3?s%=3:s=0,c=s?a.substr(0,s)+n:"",o=a.substr(s).replace(/(\d{3})(?=\d)/g,"$1"+n),r=t?i+Math.abs(e-a).toFixed(t).replace(/-/,0).slice(2):"",c+o+r}$(function(){var e=$("#js-filters"),t=$(".js-sort"),i=e.find("input[name=page]"),n=$(".js-goods-count"),a=$("#js-goods"),s=$(".js-pagination"),o=["page","_token","category_id","brand_id","tag_id","price_from","price_to"],r="",c=function(t){"undefined"==typeof t&&(t=!1),i.val(1),t&&e.trigger("submit")},l=function(){e.find("input[type=checkbox]","input[type=radio]").attr("checked",!1),e.find("input[name^=attribute]").attr("disabled",!0),$(".js-square").removeClass("active"),u.noUiSlider.set([rRange[0],rRange[1]]),c(!0)};for(var d in o)r+="[name!="+o[d]+"]";""==i.val()&&s.hide();var u=document.getElementById("js-range-slider");if(u){var f=$(u);rStart=f.data("start"),rRange=f.data("range"),noUiSlider.create(u,{start:[rStart[0],rStart[1]],connect:!0,range:{min:rRange[0],max:rRange[1]}});var p=document.getElementById("js-price-min"),v=document.getElementById("js-price-max");u.noUiSlider.on("update",function(e,t){var i=e[t];t?v.value=Math.round(i):p.value=Math.round(i)}),u.noUiSlider.on("set",function(){c()}),p.addEventListener("change",function(){u.noUiSlider.set([this.value,null])}),v.addEventListener("change",function(){u.noUiSlider.set([null,this.value])})}e.find("input[name^=attribute],select[name^=attribute]").on("change",function(e){e.preventDefault(),c()}),e.find(".js-square").on("click",function(e){c()}),e.on("submit",function(e){e.preventDefault();var t=$(this).serialize();$.post($(this).attr("action"),t,function(e){e.clear?(i.val(2),a.html($(e.items))):"all"==i.val()?a.html($(e.items)):a.append($(e.items)),null===e.next_page?s.hide():(s.show(),i.val(e.next_page)),n.html(e.count)})}),t.on("click",function(i){i.preventDefault();var n=$(this).data("sort");e.find("input[name=sort]").val(n),$(this).hasClass("active")?$(this).removeClass("active"):(t.removeClass("active"),$(this).addClass("active")),c(!0)}),s.on("click",function(t){t.preventDefault();var n=$(this).data("all");"undefined"!=typeof n&&n&&i.val("all"),e.trigger("submit")}),$(".js-filters-reset").on("click",function(e){return e.preventDefault(),l(),!1})});var mapDiv=document.getElementById("map"),mapLoad=function(e){mapDiv.removeEventListener("click",mapLoad),$.getScript("https://maps.googleapis.com/maps/api/js?key=AIzaSyBIc5obn1ArfkEzXhkgZiMyyHPRQmjNx5M",function(){init()})};mapDiv.addEventListener("click",mapLoad),$(function(){function e(e){e.find(".active").each(function(){$(this).removeClass("active"),$(this).find("input").attr("disabled",!0)})}function t(e){var t=e.data("target"),i=e.data("switch"),n=e.data("reset");"undefined"!=typeof i?$("[data-switch="+i+"]").toggleClass("active"):"undefined"!=typeof n?$(n).removeClass("active"):e.toggleClass("active"),$(t).toggleClass("active")}function i(){var e=$(".js-dropdown-women"),t=$(".js-dropdown-men"),i=$(".js-pages"),a=$(".sidebar-filter"),s=n();i.detach(),e.detach(),t.detach(),a.detach(),s?(i.insertAfter(".nav-catalog"),e.prependTo(".js-women-desktop"),t.prependTo(".js-men-desktop"),a.prependTo(".sidebar")):(e.appendTo(".js-women-mobile"),t.appendTo(".js-men-mobile"),i.insertAfter(".js-pages-mobile"),a.appendTo("#sidebar-filters"))}function n(){var e=window.getComputedStyle(document.querySelector("header"),"::before").getPropertyValue("content").replace(/"/g,"").replace(/'/g,"");return"mobile"!=e}function a(){$(".js-sidebar-open").removeClass("active"),$(".js-nav-visible").removeClass("active"),$(".js-filter-visible").removeClass("active"),$(".js-toggle-sidebar").removeClass("active"),u=!1}function s(e,t){setTimeout(function(){e.addClass("active")},300),$(t).addClass("active"),$(".js-sidebar-open").addClass("active"),u=!0}function o(e){var t=e.attr("action"),i=e.serialize(),n=e.find(".js-required-fields");r(n,!0)&&$.post(t,i,function(e){if("undefined"!=typeof e.error,"undefined"!=typeof e.action){var t=window[e.action];"function"==typeof t&&t(e)}},"json")}function r(e,t){if("undefined"==typeof e)return!1;"undefined"==typeof t&&(t=!1);var i=0;return e.each(function(e,n){"phone"==n.name?n.value.length>14?(i++,$(n).removeClass("error")):t&&$(n).addClass("error"):n.value&&n.value.length>1?(i++,$(n).removeClass("error")):t&&$(n).addClass("error")}),i==e.length}function c(e){var t=e.closest(".js-product"),i=parseInt(t.find(".js-price").data("price")),n=parseInt(t.find(".js-quantity-input").val()),a=t.find(".js-amount"),s=$(".js-total-amount"),o=i*n,r=o-parseInt(a.data("amount")),c=parseInt(s.data("total")+r);a.data("amount",o),a.text(number_format(o,0,"."," ")+"₽"),s.data("total",c),s.text(number_format(c,0,"."," ")+"₽")}var l=$("body");l.on("click",".js-toggle-active",function(e){var t=$(this),i=t.data("reset");t.hasClass(".js-prevent-default")&&e.preventDefault(),"undefined"!=typeof i&&$(i).removeClass("active"),t.toggleClass("active")}),l.on("click",".js-prevent",function(e){return e.preventDefault(),!1});var d=$(".js-square-check-filter");d&&l.on("click",".js-square",function(){var t=$(this),i=t.parent(),n=!1;i.hasClass("js-square-check-single")&&(n=!0),t.hasClass("active")?n?e(i):(t.removeClass("active"),t.find("input").attr("disabled",!0)):(n&&e(i),t.addClass("active"),t.find("input").attr("disabled",null))}),l.on("click",".js-show-more",function(e){e.preventDefault();var t=$(this);t.toggleClass("active"),t.parent().toggleClass("active")}),l.on("click",".js-select",function(){var e=$(this);e.find(".js-option").click(function(){e.find(".js-selected").text($(this).text())})}),l.on("click",".js-toggle-active-target",function(e){e.preventDefault(),t($(this))}),l.on("mouseenter",".js-toggle-active-target_over",function(){$(this).hasClass("active")||t($(this))}),l.on("mouseover",".js-hover-notice",function(){$(this).find(".popup-notice").addClass("active")}),l.on("mouseout",".js-hover-notice",function(){$(this).find(".popup-notice").removeClass("active")}),l.on("click",".js-click-notice",function(){var e,t=$(this).data("target");e="undefined"!=typeof t?$(this).closest(".popup-notice_"+t):$(this).find(".popup-notice"),e.addClass("active"),setTimeout(function(){e.removeClass("active")},6e3)}),l.on("click",".js-add-to-cart",function(e){e.preventDefault();var t=$(this),i=t.closest("form"),n=i.serializeFormJSON();if("undefined"==typeof n.size){var a=i.find(".js-popup-size");a.addClass("active"),setTimeout(function(){a.removeClass("active")},3e3)}else i.submit(),t.addClass("active")}),$.fn.serializeFormJSON=function(){var e={},t=this.serializeArray();return $.each(t,function(){e[this.name]?(e[this.name].push||(e[this.name]=[e[this.name]]),e[this.name].push(this.value||"")):e[this.name]=this.value||""}),e},$("header").on("webkitTransitionEnd transitionend oTransitionEnd",function(e){"min-height"==e.originalEvent.propertyName&&i()}),i();var u=!1;$(".js-toggle-sidebar").click(function(){var e=$(this),t=e.data("target"),i=e.hasClass("active");u?(a(),i||setTimeout(function(){s(e,t)},500)):s(e,t)}),$("#js-product-gallery-nav").carousel({vertical:!0,margin:0,responsive:{xl:{items:5,options:{margin:0,vertical:!0}},lg:{items:5,options:{margin:0,vertical:!0}},md:{items:5,options:{margin:0,vertical:!0}},sm:{items:5,options:{margin:0,vertical:!1}},xs:{items:3,options:{margin:0,vertical:!1}}}}),$("#js-product-set").carousel(),$(".js-product-carousel").carousel(),$("#js-main-banner").carousel({margin:0,pagination:!0,responsive:{xl:1,lg:1,md:1,sm:1,xs:1}}),$(".js-vk-comments-widget").on("click.vk",function(){$(this).off("click.vk"),$.getScript("//vk.com/js/api/openapi.js?145",function(){VK.init({apiId:4411901,onlyWidgets:!0}),VK.Widgets.Comments("js-vk_comments",{limit:5,attach:!1})})}),l.on("click",".js-step-next",function(e){e.preventDefault(),nextStep($(this))}),l.on("click",".js-delivery",function(e){var t=$(this),i=$(".js-total"),n=parseInt(t.find(".js-price").data("price")),a=parseInt(i.data("amount"))+n;i.text(number_format(a,0,"."," ")+" ₽")}),l.on("click","#js-order-submit",function(e){e.preventDefault();var t=$(this).closest("form");o(t)}),l.on("click",".js-play-video",function(e){e.preventDefault();var t=$(this),i=t.parent(),n=i.find("iframe");i.addClass("active"),n.attr("src",n.data("src"))}),l.on("submit",".js-form-ajax",function(e){e.preventDefault(),o($(this))}),l.on("click",".js-cart-submit",function(e){var t=$(this),i=t.data("is_fast");document.getElementById("is_fast").value=i,i&&(e.preventDefault(),o(t.closest("form")))}),l.on("click",".js-quantity",function(){var e=$(this),t=parseInt(e.data("num")),i=e.parent().find(".js-quantity-input"),n=parseInt(i.val()),a=n+t;a>0&&i.val(a),"undefined"!=typeof e.data("submit")?e.closest("form").submit():c(e)});var f;l.on("keyup",".js-quantity-input",function(){clearTimeout(f);var e=$(this);f=setTimeout(function(){"undefined"!=typeof e.data("submit")?e.closest("form").submit():c(e)},1e3)}),l.on("click",".js-action-link",function(e){e.preventDefault();var t=$(this).data("action");$.get(t,null,function(e){if("undefined"!=typeof e.error,"undefined"!=typeof e.action){var t=window[e.action];"function"==typeof t&&t(e)}})}),$(".js-phone").mask("+7 000 000 00 000",{placeholder:"+7 ___ ___ __ __"}),l.on("input",".js-required-fields",function(e){var t=$(".js-required-fields");r(t)?$(".js-step-next").attr("disabled",!1):$(".js-step-next").attr("disabled",!0)}),l.on("click",".js-gallery-thumb",function(e){var t=$(this),i=$(".js-gallery-big");$(".js-gallery-thumb").removeClass("active"),t.addClass("active"),i.removeClass("active"),i.eq(t.index()).addClass("active")})}),$(function(){function e(){var e=$(".js-dropdown-women"),i=$(".js-dropdown-men"),n=$(".js-pages"),a=$(".sidebar-filter"),s=t();n.detach(),e.detach(),i.detach(),a.detach(),s?(n.insertAfter(".nav-catalog"),e.prependTo(".js-women-desktop"),i.prependTo(".js-men-desktop"),a.prependTo(".sidebar")):(e.appendTo(".js-women-mobile"),i.appendTo(".js-men-mobile"),n.insertAfter(".js-pages-mobile"),a.appendTo("#sidebar-filters"))}function t(){var e=window.getComputedStyle(document.querySelector("header"),"::before").getPropertyValue("content").replace(/"/g,"").replace(/'/g,"");return"mobile"!=e}function i(){$(".js-sidebar-open").removeClass("active"),$(".js-nav-visible").removeClass("active"),$(".js-filter-visible").removeClass("active"),$(".js-toggle-sidebar").removeClass("active"),s=!1}function n(e,t){setTimeout(function(){e.addClass("active")},300),$(t).addClass("active"),$(".js-sidebar-open").addClass("active"),s=!0}function a(e,t){t||(t=$("#product-reviews").data("count")),e||(e=$(".product-review").length);var i=t-e;if(i>20&&(i=20),i>0){var n="("+i+")";$("#product-reviews .btn_more .count").text(n)}else $(".product-reviews-navigation:first").hide()}$(".js-toggle-active").click(function(e){var t=$(this),i=t.data("reset");t.hasClass(".js-prevent-default")&&e.preventDefault(),"undefined"!=typeof i&&$(i).removeClass("active"),t.toggleClass("active")}),$(".js-prevent").click(function(e){return e.preventDefault(),!1}),$(".js-show-more").click(function(e){e.preventDefault();var t=$(this);t.toggleClass("active"),t.parent().toggleClass("active")}),$(".js-select").each(function(){var e=$(this);e.find(".js-option").click(function(){e.find(".js-selected").text($(this).text())})}),$(".js-toggle-active-target_over").mouseenter(function(){$(this).hasClass("active")||toggleActiveTarget($(this))}),$(".js-hover-notice").hover(function(){$(this).find(".popup-notice").toggleClass("active")}),$(".js-click-notice").click(function(){var e,t=$(this).data("target");e="undefined"!=typeof t?$(this).closest(".popup-notice_"+t):$(this).find(".popup-notice"),e.addClass("active"),setTimeout(function(){e.removeClass("active")},6e3)}),$(".js-add-to-cart").click(function(e){e.preventDefault();var t=$(this).closest("form"),i=t.serializeFormJSON();if("undefined"==typeof i.size){var n=t.find(".js-popup-size");n.addClass("active"),setTimeout(function(){n.removeClass("active")},3e3)}else $(this).addClass("active")}),$.fn.serializeFormJSON=function(){var e={},t=this.serializeArray();return $.each(t,function(){e[this.name]?(e[this.name].push||(e[this.name]=[e[this.name]]),e[this.name].push(this.value||"")):e[this.name]=this.value||""}),e},$("header").on("webkitTransitionEnd transitionend oTransitionEnd",function(t){"min-height"==t.originalEvent.propertyName&&e()}),e();var s=!1;$(".js-toggle-sidebar").click(function(){var e=$(this),t=e.data("target"),a=e.hasClass("active");s?(i(),a||setTimeout(function(){n(e,t)},500)):n(e,t)}),$("#js-product-gallery-nav").carousel({vertical:!0,margin:0,responsive:{xl:{items:5,options:{margin:0,vertical:!0}},lg:{items:5,options:{margin:0,vertical:!0}},md:{items:5,options:{margin:0,vertical:!0}},sm:{items:5,options:{margin:0,vertical:!1}},xs:{items:4,options:{margin:0,vertical:!1}}}}),$("#js-product-set").carousel(),$(".js-product-carousel").carousel(),$(".js-vk-comments-widget").on("click.vk",function(){$(this).off("click.vk"),$.getScript("//vk.com/js/api/openapi.js?145",function(){VK.init({apiId:API_ID,onlyWidgets:!0}),VK.Widgets.Comments("js-vk_comments",{limit:5,attach:!1})})}),$(".product-review-form").on("submit",function(e){e.preventDefault();var t=$(this);return $.post(t.attr("action"),t.serialize(),function(e){if("ok"===e.result){var i=t.find(".form-success__title"),n=t.find(".product-review-form__body");n.children().css("display","none"),i.text("Спасибо, "+t.get(0).name.value+"!"),n.find(".form-success").css("display","block")}}),!1}),a(),$("#product-reviews .btn_more").click(function(e){var t=$(this),i=$("#product-reviews").data("count"),n=$(".product-review").length,s={product_id:t.data("product-id"),count:20,skip:n};$.get("/get/comments",s,function(e){e&&($(".product-reviews-navigation").before(e),a(null,i))})}),$("#product-reviews .btn_show-all").click(function(e){var t=$(this),i={product_id:t.data("product-id")};$.get("/get/comments",i,function(e){e&&($(".product-review").remove(),$("#product-reviews").prepend(e),$(".product-reviews-navigation:first").hide())})})});